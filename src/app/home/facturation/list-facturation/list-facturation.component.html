<!-- entete -->
    <div class=" card p-3 position-sticky top-0 z-1">
    <div class="d-flex align-items-center justify-content-between mb-1">
      <div class="fs-4 fw-bold">
        Facturations {{list.length==les_facturations.length?list.length:list.length + "/" + les_facturations.length}}
      </div>
      <div class="d-flex">
        <button class="btn btn-primary" (click)="openModal_add_facturation()"><i class="bi bi-plus-square-dotted"></i> Facturation</button>
      </div>
    </div>
    <div class="d-flex gap-1 justify-content-end">
      <ng-select [multiple]="true" [closeOnSelect]="false" placeholder="Rechercher ici ..." notFoundText="Aucun résultat" class="no-limit" [(ngModel)]="filter.text" (search)="filter_change($event)" (change)="filter_change()"
        style="min-width: 400px;">
        <!-- <ng-option disabled>Zones</ng-option>
        @for (let zone of donnees_select.zone) {
          <ng-option [value]="'zone_'+zone.id_zone">
            {{ zone.nom }}
          </ng-option>
        }

        <ng-option disabled>Domaines</ng-option>
        @for (let domaine of donnees_select.domaine) {
          <ng-option [value]="'domaine_'+domaine.id_domaine">
            {{ domaine.nom }}
          </ng-option>
        }-->
      </ng-select>
    </div>
  </div>
<!-- entête inchangée au-dessus -->

<div class="table-responsive">
  <table class="table align-middle">
    <thead class="table-light">
      <tr>
        <th>N° facture</th>
        <th>Enfant</th>
        <th>Mois</th>
        <th>Libellé</th>
       
        <th class="text-end">Total</th>
        <th>Statut</th>
        <th class="text-center">Actions</th>
      </tr>
    </thead>

    <tbody>
      @if (loading_get_facturation) {
        <tr>
          <td colspan="11" class="text-center py-4">
            <div class="spinner-border" role="status"></div>
          </td>
        </tr>
      }
      @if (!loading_get_facturation && list.length === 0) {
        <tr><td colspan="11" class="text-center text-secondary py-4">Aucune facture</td></tr>
      }

      @for (f of list; track f) {
        <tr>
          <td class="fw-semibold">{{ f.numero_facture || '—' }}</td>
          <td>{{ fullname(f) }}</td>
          <td>{{ f.mois_facture || '—' }}</td>
          <td class="text-truncate" style="max-width: 260px">{{ f.libelle_facturation }}</td>

         
          <td class="text-end fw-bold">{{ money(f.montant_total) }}</td>

          <td>
            <span class="badge" [ngClass]="statusClass(f)">
              {{ f.libelle_statut_facture || '—' }}
            </span>
          </td>

          <td class="text-center">
            <!-- Voir -->
            <a class="btn btn-sm btn-outline-primary me-1"
               [routerLink]="['/home/facturation', f.id_facturation]"
               title="Voir la facture">
              <i class="bi bi-eye"></i>
            </a>

            <!-- Éditer / Supprimer déjà présents -->
            <button class="btn btn-sm btn-outline-secondary me-1"
                    (click)="openModal_edit_facturation(f)" title="Modifier">
              <i class="bi bi-pencil-square"></i>
            </button>

           
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>
