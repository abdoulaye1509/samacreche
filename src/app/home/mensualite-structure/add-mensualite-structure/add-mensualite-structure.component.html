<!-- Header -->
<div class="modal-header bg-transparent border-0 pt-3" data-bs-theme="light">
  <div class="w-100 position-relative">
    <h1 class="modal-title fs-5 mb-0 d-flex align-items-center gap-2">
      Ajouter une mensualité structure
    </h1>
    <button type="button" class="btn-close position-absolute end-0 top-50 translate-middle-y" aria-label="Close"
      (click)="activeModal.close()">
    </button>
  </div>
</div>

<!-- Body -->
<div class="modal-body p-0">
  <form [formGroup]="reactiveForm_add_mensualite_structure" (ngSubmit)="onSubmit_add_mensualite_structure()"
    #form_add_mensualite_structure="ngForm">

    <div class="sheet p-3 p-md-4">
      <div class="section-cap">Mensualité</div>
      <hr class="py-2" />

      <div class="row g-3 align-items-end">


        <!-- Libellé -->
        <div class="col-xl-4 col-md-6">
          <label class="form-label required" for="libelle_mensualite">Libellé</label>
          <input id="libelle_mensualite" class="form-control" type="text" formControlName="libelle_mensualite"
            placeholder="Ex. : Mensualité standard"
            [ngClass]="{ 'is-invalid': submitted && f.libelle_mensualite?.errors }" />
          <div class="invalid-feedback" *ngIf="submitted && f.libelle_mensualite?.errors">
            <div *ngIf="f.libelle_mensualite?.errors?.['required']">Ce champ est obligatoire</div>
          </div>
        </div>

        <!-- Montant total -->
        <!-- Montant total -->
        <div class="col-xl-4 col-md-6">
          <label class="form-label required" for="montant_total">Montant total</label>
          <input id="montant_total" class="form-control" type="text" inputmode="decimal" placeholder="Ex. : 25,000"
            [value]="api.formatMontant(f.montant_total?.value, 0)"
            (input)="api.formatMontantInput($event, reactiveForm_add_mensualite_structure, 'montant_total', {decimals: 0})"
            [ngClass]="{ 'is-invalid': submitted && f.montant_total?.errors }" />

          <div class="invalid-feedback" *ngIf="submitted && f.montant_total?.errors">
            <div *ngIf="f.montant_total?.errors?.['required']">Ce champ est obligatoire</div>
            <div *ngIf="f.montant_total?.errors?.['min']">Le montant doit être ≥ 0</div>
          </div>
        </div>

      </div>

      <div class="row g-3 align-items-end mt-1">
        <!-- Description -->
        <div class="col-12">
          <label class="form-label" for="description_mensualite">Description</label>
          <textarea id="description_mensualite" class="form-control" rows="2" formControlName="description_mensualite"
            placeholder="Note ou description (facultatif)"></textarea>
        </div>
      </div>
    </div>
  </form>
</div>

<!-- Footer -->
<div class="modal-footer bg-transparent border-0 pt-0 pb-4 px-4">
  <div class="w-100 d-flex justify-content-end">
    <button type="button" class="btn btn-success px-4 py-2 rounded-pill shadow-sm"
      [disabled]="loading_add_mensualite_structure || loading_get_details_add_mensualite_structure_form"
      (click)="form_add_mensualite_structure.ngSubmit.emit()">
      <span *ngIf="loading_add_mensualite_structure" class="spinner-border spinner-border-sm me-2" role="status"></span>
      {{ loading_add_mensualite_structure ? 'En cours...' : 'Ajouter' }}
    </button>
  </div>
</div>