
<!-- entete -->
<div class=" card p-3 position-sticky top-0 z-1">
  <div class="d-flex align-items-center justify-content-between mb-1">
    <div class="fs-4 fw-bold">
      Structures {{list.length==les_structures.length?list.length:list.length + "/" + les_structures.length}}
    </div>
    <div class="d-flex">
      <button class="btn btn-primary" (click)="openModal_add_structure()">
        <i class="bi bi-plus-square-dotted"></i> Structure
      </button>
    </div>
  </div>

  <div class="d-flex gap-1 justify-content-end">
    <ng-select [multiple]="true" [closeOnSelect]="false" placeholder="Rechercher ici ..." notFoundText="Aucun résultat"
      class="no-limit" [(ngModel)]="filter.text" (search)="filter_change($event)" (change)="filter_change()"
      style="min-width: 400px;">
    </ng-select>
  </div>
</div>

<!-- Liste en cards -->
<div class="mt-3">

  <!-- chargement -->
  @if (loading_get_structure) {
  <div class="d-flex justify-content-center my-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
  </div>
  }

  <!-- aucune donnée -->
  @if (!loading_get_structure && list.length === 0) {
  <div class="alert alert-info text-center my-4">
    Aucune donnée trouvée.
  </div>
  }

  <!-- grille de cartes -->
  <div class="row g-3" *ngIf="!loading_get_structure && list.length > 0">
    @for (one_structure of list; track one_structure) {
    <div class="col-12 col-sm-6 col-md-4 col-xl-3">
      <div class="card h-100 structure-card shadow-sm">

        <div class="structure-logo-wrapper">
          <img class="structure-logo" [src]="api.resolveFileUrl(one_structure.logo_structure || '')"
            (error)="$any($event.target).src = api.placeholderLogo"
            [alt]="'Logo ' + (one_structure.nom_structure || '')" />
        </div>


        <div class="card-body d-flex flex-column">
          <h5 class="card-title mb-1">
            {{ one_structure.nom_structure }}
          </h5>
         

          <p class="card-text small mb-1">
            <i class="bi bi-geo-alt me-1"></i>
            {{ one_structure.adresse_structure || 'Adresse non renseignée' }}
          </p>

          <p class="card-text small mb-1">
            <i class="bi bi-telephone me-1"></i>
            {{ one_structure.telephone_structure || '—' }}
          </p>

         

          <div class="mt-auto d-flex justify-content-end gap-2">
            <button type="button" class="btn btn-sm btn-outline-secondary"
              (click)="openModal_edit_structure(one_structure)" title="Modifier">
              <i class="bi bi-pencil-square"></i>
            </button>

            <button type="button" class="btn btn-sm btn-outline-danger" (click)="delete_structure(one_structure)"
              title="Supprimer">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </div>

      </div>
    </div>
    }
  </div>
</div>