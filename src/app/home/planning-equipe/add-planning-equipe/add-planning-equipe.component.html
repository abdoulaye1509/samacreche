<div class="modal-header">
  <h5 class="modal-title">
    <i class="bi bi-people-fill me-2"></i> Ajouter un planning d’équipe
  </h5>
  <button type="button" class="btn-close" aria-label="Fermer" (click)="activeModal.close()"></button>
</div>

<div class="modal-body">
  <form [formGroup]="reactiveForm_add_planning_equipe"
        (ngSubmit)="onSubmit_add_planning_equipe()"
        #form_add_planning_equipe="ngForm"
        class="row g-3">

 
    <!-- Utilisateur -->
<div class="col-12">
  <label class="form-label">
    <i class="bi bi-person-badge me-1"></i> Agent
  </label>

  <ng-select
    [items]="form_details?.les_utilisateurs || []"
    bindValue="id_utilisateur"
    placeholder="Choisir l’utilisateur"
    formControlName="id_utilisateur"
    [searchable]="true"
    [ngClass]="{ 'is-invalid': submitted && f['id_utilisateur'].errors }">

    <!-- libellé affiché une fois sélectionné -->
    <ng-template ng-label-tmp let-item="item">
      {{ item.prenom_utilisateur }} {{ item.nom_utilisateur }}
    </ng-template>

    <!-- options de la liste -->
    <ng-template ng-option-tmp let-item="item">
      <i class="bi bi-person-circle me-2"></i>
      {{ item.prenom_utilisateur }} {{ item.nom_utilisateur }}
    </ng-template>
  </ng-select>

  <div class="invalid-feedback" *ngIf="submitted && f['id_utilisateur'].errors">Requis</div>
</div>

    <!-- Titre -->
    <div class="col-md-8">
      <label class="form-label"><i class="bi bi-card-text me-1"></i> Titre</label>
      <input class="form-control" type="text" placeholder="Ex. Réunion parents"
             formControlName="titre_planning_equipe"
             [ngClass]="{ 'is-invalid': submitted && f['titre_planning_equipe'].errors }">
      <div class="invalid-feedback" *ngIf="submitted && f['titre_planning_equipe'].errors">Requis</div>
    </div>

    <!-- Couleur -->
    <div class="col-md-4">
      <label class="form-label d-flex align-items-center gap-2">
        <i class="bi bi-palette2"></i> Couleur
      </label>
      <input class="form-control form-control-color p-1" type="color"
             formControlName="couleur"
             [ngClass]="{ 'is-invalid': submitted && f['couleur'].errors }">
    </div>

    <!-- Description -->
    <div class="col-12">
      <label class="form-label"><i class="bi bi-chat-left-text me-1"></i> Description</label>
      <textarea class="form-control" rows="2" placeholder="Notes, contexte…"
                formControlName="description_planning_equipe"></textarea>
    </div>

    <!-- Dates -->
    <div class="col-sm-6">
      <label class="form-label"><i class="bi bi-calendar-event me-1"></i> Du</label>
      <input class="form-control" type="date"
             formControlName="date_debut"
             [ngClass]="{ 'is-invalid': submitted && f['date_debut'].errors }">
      <div class="invalid-feedback" *ngIf="submitted && f['date_debut'].errors">Requis</div>
    </div>
    <div class="col-sm-6">
      <label class="form-label"><i class="bi bi-calendar-event me-1"></i> Au</label>
      <input class="form-control" type="date"
             formControlName="date_fin"
             [ngClass]="{ 'is-invalid': submitted && f['date_fin'].errors }">
      <div class="invalid-feedback" *ngIf="submitted && f['date_fin'].errors">Requis</div>
    </div>

    <!-- Heures -->
    <div class="col-sm-6">
      <label class="form-label"><i class="bi bi-alarm me-1"></i> Heure début</label>
      <input class="form-control" type="time" formControlName="heure_debut">
    </div>
    <div class="col-sm-6">
      <label class="form-label"><i class="bi bi-alarm me-1"></i> Heure fin</label>
      <input class="form-control" type="time" formControlName="heure_fin">
    </div>
  </form>
</div>

<div class="modal-footer">
  <button type="button" class="btn btn-primary"
          [disabled]="loading_add_planning_equipe || loading_get_details_add_planning_equipe_form"
          (click)="form_add_planning_equipe.ngSubmit.emit()">
    <i class="bi bi-check2-circle me-1"></i>
    {{ loading_add_planning_equipe ? 'En cours…' : 'Valider' }}
  </button>
  <button type="button" class="btn btn-outline-secondary" (click)="activeModal.close()">Fermer</button>
</div>
